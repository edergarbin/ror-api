  [1m[35m (17.4ms)[0m  [1m[35mDROP DATABASE IF EXISTS "ror_api_test"[0m
  [1m[35m (55.7ms)[0m  [1m[35mCREATE DATABASE "ror_api_test" ENCODING = 'unicode'[0m
  [1m[35mSQL (1.1ms)[0m  [1m[35mCREATE EXTENSION IF NOT EXISTS "plpgsql"[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "products" CASCADE[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE TABLE "products" ("id" bigserial primary key, "name" character varying, "quantity" integer, "price_in_cents" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[35mDROP TABLE IF EXISTS "sales" CASCADE[0m
  [1m[35m (4.1ms)[0m  [1m[35mCREATE TABLE "sales" ("id" bigserial primary key, "quantity" integer, "total_in_cents" integer, "product_id" bigint NOT NULL, "user_id" bigint NOT NULL, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE INDEX "index_sales_on_product_id" ON "sales" ("product_id")[0m
  [1m[35m (1.8ms)[0m  [1m[35mCREATE INDEX "index_sales_on_user_id" ON "sales" ("user_id")[0m
  [1m[35m (0.1ms)[0m  [1m[35mDROP TABLE IF EXISTS "users" CASCADE[0m
  [1m[35m (4.3ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "name" character varying, "email" character varying, "password" character varying, "password_digest" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.5ms)[0m  [1m[35mALTER TABLE "sales" ADD CONSTRAINT "fk_rails_afd82832c8"
FOREIGN KEY ("product_id")
  REFERENCES "products" ("id")
[0m
  [1m[35m (1.6ms)[0m  [1m[35mALTER TABLE "sales" ADD CONSTRAINT "fk_rails_8e94f16ccc"
FOREIGN KEY ("user_id")
  REFERENCES "users" ("id")
[0m
  [1m[35m (3.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES (20230228134514)[0m
  [1m[35m (0.8ms)[0m  [1m[32mINSERT INTO "schema_migrations" (version) VALUES
(20230228133938),
(20230228134140);

[0m
  [1m[35m (4.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "test"], ["created_at", "2023-02-28 14:38:53.870392"], ["updated_at", "2023-02-28 14:38:53.870392"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.1ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "schema_sha1"], ["value", "17d3c44e3844d0fa3f93a73a0fb34cd1e83075c3"], ["created_at", "2023-02-28 14:38:53.874523"], ["updated_at", "2023-02-28 14:38:53.874523"]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "sales" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (3.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.9ms)[0m  [1m[31mDELETE FROM "products";
DELETE FROM "sales";
DELETE FROM "users";
INSERT INTO "products" ("id", "name", "quantity", "price_in_cents", "created_at", "updated_at") VALUES (980190962, 'MyString', 1, 1, '2023-02-28 14:42:15.287309', '2023-02-28 14:42:15.287309'), (298486374, 'MyString', 1, 1, '2023-02-28 14:42:15.287309', '2023-02-28 14:42:15.287309');
INSERT INTO "sales" ("id", "quantity", "total_in_cents", "product_id", "user_id", "created_at", "updated_at") VALUES (980190962, 1, 1, 980190962, 980190962, '2023-02-28 14:42:15.290468', '2023-02-28 14:42:15.290468'), (298486374, 1, 1, 298486374, 298486374, '2023-02-28 14:42:15.290468', '2023-02-28 14:42:15.290468');
INSERT INTO "users" ("id", "name", "email", "password", "password_digest", "created_at", "updated_at") VALUES (980190962, 'MyString', 'MyString', 'MyString', 'MyString', '2023-02-28 14:42:15.293065', '2023-02-28 14:42:15.293065'), (298486374, 'MyString', 'MyString', 'MyString', 'MyString', '2023-02-28 14:42:15.293065', '2023-02-28 14:42:15.293065')[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "sales" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.5ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_constraint SET convalidated=false WHERE conname = ''%I'' AND connamespace::regnamespace = ''%I''::regnamespace; ALTER TABLE %I.%I VALIDATE CONSTRAINT %I;',
    constraint_name,
    table_schema,
    table_schema,
    table_name,
    constraint_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ProductsControllerTest: test_should_create_produto
--------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
ProductsControllerTest: test_should_destroy_product
---------------------------------------------------
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mProduct Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
ProductsControllerTest - test_should_destroy_product: ActionController::UrlGenerationError raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ProductsControllerTest: test_should_update_product
--------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ProductsControllerTest: test_should_show_product
------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
ProductsControllerTest: test_should_get_index
---------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/products" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by ProductsController#index as JSON
  Parameters: {"product"=>{}}
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
Completed 200 OK in 7ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 21241)
  [1m[36mTRANSACTION (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
UsersControllerTest: test_should_create_user
--------------------------------------------
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/users" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}}
[31mUnpermitted parameter: :password_digest. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f86e4572458>, params: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 7ms (Views: 5.6ms | ActiveRecord: 0.0ms | Allocations: 3340)
  [1m[36mCACHE User Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_destroy_user
---------------------------------------------
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started DELETE "/users/980190962" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by UsersController#destroy as JSON
  Parameters: {"id"=>"980190962", "user"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.8ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 3ms (ActiveRecord: 1.2ms | Allocations: 863)
UsersControllerTest - test_should_destroy_user: ActiveRecord::InvalidForeignKey raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
UsersControllerTest: test_should_update_user
--------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/users/980190962" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by UsersController#update as JSON
  Parameters: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "id"=>"980190962"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :password_digest. Context: { controller: UsersController, action: update, request: #<ActionDispatch::Request:0x00007f86e498a5e0>, params: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "controller"=>"users", "action"=>"update", "id"=>"980190962"} }[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 782)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_should_show_user
------------------------------------------
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/users/980190962" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by UsersController#show as JSON
  Parameters: {"id"=>"980190962", "user"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 319)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_should_get_index
------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/users" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by UsersController#index as JSON
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 405)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
SalesControllerTest: test_should_create_sale
--------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
Started POST "/sales" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by SalesController#create as JSON
  Parameters: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}}
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055aef8399160>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055aef8399160>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mProduct Load (0.4ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055aef8399160>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055aef8399160>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Create (0.5ms)[0m  [1m[32mINSERT INTO "sales" ("quantity", "total_in_cents", "product_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["quantity", 1], ["total_in_cents", 1], ["product_id", 980190962], ["user_id", 980190962], ["created_at", "2023-02-28 14:42:15.480187"], ["updated_at", "2023-02-28 14:42:15.480187"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055aef8399160>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Update (0.2ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 0], ["updated_at", "2023-02-28 14:42:15.482149"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 14ms (Views: 0.4ms | ActiveRecord: 1.7ms | Allocations: 6283)
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
SalesControllerTest: test_should_destroy_sale
---------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
Started DELETE "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by SalesController#destroy as JSON
  Parameters: {"id"=>"980190962", "sale"=>{}}
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSale Destroy (0.1ms)[0m  [1m[31mDELETE FROM "sales" WHERE "sales"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.4ms | Allocations: 520)
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
SalesControllerTest: test_should_update_sale
--------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by SalesController#update as JSON
  Parameters: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "id"=>"980190962"}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: update, request: #<ActionDispatch::Request:0x00007f86e4f9a9d0>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"update", "id"=>"980190962"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.3ms | Allocations: 1073)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
SalesControllerTest: test_should_show_sale
------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by SalesController#show as JSON
  Parameters: {"id"=>"980190962", "sale"=>{}}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 281)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
SalesControllerTest: test_should_get_index
------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/sales" for 127.0.0.1 at 2023-02-28 11:42:15 -0300
Processing by SalesController#index as JSON
  Parameters: {"sale"=>{}}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales"[0m
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.1ms | Allocations: 368)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "sales" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.7ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[31mDELETE FROM "products";
DELETE FROM "sales";
DELETE FROM "users";
INSERT INTO "products" ("id", "name", "quantity", "price_in_cents", "created_at", "updated_at") VALUES (980190962, 'MyString', 1, 1, '2023-02-28 14:43:45.309239', '2023-02-28 14:43:45.309239'), (298486374, 'MyString', 1, 1, '2023-02-28 14:43:45.309239', '2023-02-28 14:43:45.309239');
INSERT INTO "sales" ("id", "quantity", "total_in_cents", "product_id", "user_id", "created_at", "updated_at") VALUES (980190962, 1, 1, 980190962, 980190962, '2023-02-28 14:43:45.312998', '2023-02-28 14:43:45.312998'), (298486374, 1, 1, 298486374, 298486374, '2023-02-28 14:43:45.312998', '2023-02-28 14:43:45.312998');
INSERT INTO "users" ("id", "name", "email", "password", "password_digest", "created_at", "updated_at") VALUES (980190962, 'MyString', 'MyString', 'MyString', 'MyString', '2023-02-28 14:43:45.315576', '2023-02-28 14:43:45.315576'), (298486374, 'MyString', 'MyString', 'MyString', 'MyString', '2023-02-28 14:43:45.315576', '2023-02-28 14:43:45.315576')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.1ms)[0m  [1m[35mALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "sales" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (3.4ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_constraint SET convalidated=false WHERE conname = ''%I'' AND connamespace::regnamespace = ''%I''::regnamespace; ALTER TABLE %I.%I VALIDATE CONSTRAINT %I;',
    constraint_name,
    table_schema,
    table_schema,
    table_name,
    constraint_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
SalesControllerTest: test_should_show_sale
------------------------------------------
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by SalesController#show as JSON
  Parameters: {"id"=>"980190962", "sale"=>{}}
  [1m[36mSale Load (0.3ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 8ms (Views: 0.4ms | ActiveRecord: 0.3ms | Allocations: 21392)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
SalesControllerTest: test_should_create_sale
--------------------------------------------
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Count (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
Started POST "/sales" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by SalesController#create as JSON
  Parameters: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}}
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055ee99c9d370>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055ee99c9d370>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055ee99c9d370>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055ee99c9d370>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.8ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Create (0.5ms)[0m  [1m[32mINSERT INTO "sales" ("quantity", "total_in_cents", "product_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["quantity", 1], ["total_in_cents", 1], ["product_id", 980190962], ["user_id", 980190962], ["created_at", "2023-02-28 14:43:45.448223"], ["updated_at", "2023-02-28 14:43:45.448223"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x000055ee99c9d370>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Update (0.1ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 0], ["updated_at", "2023-02-28 14:43:45.450352"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 32ms (Views: 0.5ms | ActiveRecord: 2.6ms | Allocations: 34440)
  [1m[36mSale Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
SalesControllerTest: test_should_get_index
------------------------------------------
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/sales" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by SalesController#index as JSON
  Parameters: {"sale"=>{}}
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales"[0m
Completed 200 OK in 1ms (Views: 0.8ms | ActiveRecord: 0.2ms | Allocations: 387)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
SalesControllerTest: test_should_update_sale
--------------------------------------------
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by SalesController#update as JSON
  Parameters: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "id"=>"980190962"}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: update, request: #<ActionDispatch::Request:0x00007f8c6cc64f58>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"update", "id"=>"980190962"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 2ms (Views: 0.2ms | ActiveRecord: 0.4ms | Allocations: 1085)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
SalesControllerTest: test_should_destroy_sale
---------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
Started DELETE "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by SalesController#destroy as JSON
  Parameters: {"id"=>"980190962", "sale"=>{}}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSale Destroy (0.1ms)[0m  [1m[31mDELETE FROM "sales" WHERE "sales"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.3ms | Allocations: 426)
  [1m[36mSale Count (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ProductsControllerTest: test_should_show_product
------------------------------------------------
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/products/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by ProductsController#show as JSON
  Parameters: {"id"=>"980190962", "product"=>{}}
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.3ms | ActiveRecord: 0.2ms | Allocations: 545)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ProductsControllerTest: test_should_create_product
--------------------------------------------------
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mProduct Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
Started POST "/products" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by ProductsController#create as JSON
  Parameters: {"product"=>{"name"=>"MyString", "price_in_cents"=>1, "quantity"=>1}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Create (0.2ms)[0m  [1m[32mINSERT INTO "products" ("name", "quantity", "price_in_cents", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "MyString"], ["quantity", 1], ["price_in_cents", 1], ["created_at", "2023-02-28 14:43:45.481407"], ["updated_at", "2023-02-28 14:43:45.481407"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 2ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 783)
  [1m[36mProduct Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
ProductsControllerTest: test_should_get_index
---------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/products" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by ProductsController#index as JSON
  Parameters: {"product"=>{}}
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
Completed 200 OK in 1ms (Views: 0.4ms | ActiveRecord: 0.2ms | Allocations: 368)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ProductsControllerTest: test_should_update_product
--------------------------------------------------
  [1m[36mProduct Load (0.3ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/products/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by ProductsController#update as JSON
  Parameters: {"product"=>{"name"=>"MyString", "price_in_cents"=>1, "quantity"=>1}, "id"=>"980190962"}
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 473)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
ProductsControllerTest: test_should_destroy_product
---------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mProduct Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
Started DELETE "/products/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by ProductsController#destroy as JSON
  Parameters: {"id"=>"980190962", "product"=>{}}
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Destroy (0.4ms)[0m  [1m[31mDELETE FROM "products" WHERE "products"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.6ms | Allocations: 596)
ProductsControllerTest - test_should_destroy_product: ActiveRecord::InvalidForeignKey raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_should_show_user
------------------------------------------
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/users/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by UsersController#show as JSON
  Parameters: {"id"=>"980190962", "user"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 2ms (Views: 0.3ms | ActiveRecord: 0.2ms | Allocations: 738)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
UsersControllerTest: test_should_create_user
--------------------------------------------
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/users" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}}
[31mUnpermitted parameter: :password_digest. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f8c6cf705d0>, params: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 7ms (Views: 6.1ms | ActiveRecord: 0.0ms | Allocations: 1759)
  [1m[36mCACHE User Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_should_get_index
------------------------------------------
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/users" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by UsersController#index as JSON
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 405)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
UsersControllerTest: test_should_update_user
--------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/users/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by UsersController#update as JSON
  Parameters: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "id"=>"980190962"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :password_digest. Context: { controller: UsersController, action: update, request: #<ActionDispatch::Request:0x000055ee99acb560>, params: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "controller"=>"users", "action"=>"update", "id"=>"980190962"} }[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.1ms | Allocations: 779)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_destroy_user
---------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started DELETE "/users/980190962" for 127.0.0.1 at 2023-02-28 11:43:45 -0300
Processing by UsersController#destroy as JSON
  Parameters: {"id"=>"980190962", "user"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.6ms | Allocations: 545)
UsersControllerTest - test_should_destroy_user: ActiveRecord::InvalidForeignKey raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "products" DISABLE TRIGGER ALL;ALTER TABLE "sales" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" DISABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[31mDELETE FROM "products";
DELETE FROM "sales";
DELETE FROM "users";
INSERT INTO "products" ("id", "name", "quantity", "price_in_cents", "created_at", "updated_at") VALUES (980190962, 'MyString', 1, 1, '2023-02-28 14:46:16.796080', '2023-02-28 14:46:16.796080'), (298486374, 'MyString', 1, 1, '2023-02-28 14:46:16.796080', '2023-02-28 14:46:16.796080');
INSERT INTO "sales" ("id", "quantity", "total_in_cents", "product_id", "user_id", "created_at", "updated_at") VALUES (980190962, 1, 1, 980190962, 980190962, '2023-02-28 14:46:16.799002', '2023-02-28 14:46:16.799002'), (298486374, 1, 1, 298486374, 298486374, '2023-02-28 14:46:16.799002', '2023-02-28 14:46:16.799002');
INSERT INTO "users" ("id", "name", "email", "password", "password_digest", "created_at", "updated_at") VALUES (980190962, 'MyString', 'MyString', 'MyString', 'MyString', '2023-02-28 14:46:16.802504', '2023-02-28 14:46:16.802504'), (298486374, 'MyString', 'MyString', 'MyString', 'MyString', '2023-02-28 14:46:16.802504', '2023-02-28 14:46:16.802504')[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.2ms)[0m  [1m[35mALTER TABLE "products" ENABLE TRIGGER ALL;ALTER TABLE "sales" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ar_internal_metadata" ENABLE TRIGGER ALL[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (2.6ms)[0m  [1m[35mdo $$
  declare r record;
BEGIN
FOR r IN (
  SELECT FORMAT(
    'UPDATE pg_constraint SET convalidated=false WHERE conname = ''%I'' AND connamespace::regnamespace = ''%I''::regnamespace; ALTER TABLE %I.%I VALIDATE CONSTRAINT %I;',
    constraint_name,
    table_schema,
    table_schema,
    table_name,
    constraint_name
  ) AS constraint_check
  FROM information_schema.table_constraints WHERE constraint_type = 'FOREIGN KEY'
)
  LOOP
    EXECUTE (r.constraint_check);
  END LOOP;
END;
$$;
[0m
  [1m[36mTRANSACTION (0.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ProductsControllerTest: test_should_update_product
--------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/products/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by ProductsController#update as JSON
  Parameters: {"product"=>{"name"=>"MyString", "price_in_cents"=>1, "quantity"=>1}, "id"=>"980190962"}
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 8ms (Views: 0.3ms | ActiveRecord: 0.2ms | Allocations: 21894)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------------
ProductsControllerTest: test_should_create_product
--------------------------------------------------
  [1m[36mProduct Load (0.2ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mProduct Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
Started POST "/products" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by ProductsController#create as JSON
  Parameters: {"product"=>{"name"=>"MyString", "price_in_cents"=>1, "quantity"=>1}}
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Create (0.2ms)[0m  [1m[32mINSERT INTO "products" ("name", "quantity", "price_in_cents", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "MyString"], ["quantity", 1], ["price_in_cents", 1], ["created_at", "2023-02-28 14:46:16.904424"], ["updated_at", "2023-02-28 14:46:16.904424"]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 2ms (Views: 0.3ms | ActiveRecord: 0.4ms | Allocations: 1043)
  [1m[36mProduct Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------------
ProductsControllerTest: test_should_show_product
------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/products/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by ProductsController#show as JSON
  Parameters: {"id"=>"980190962", "product"=>{}}
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 446)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------------
ProductsControllerTest: test_should_destroy_product
---------------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mProduct Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "products"[0m
Started DELETE "/products/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by ProductsController#destroy as JSON
  Parameters: {"id"=>"980190962", "product"=>{}}
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Destroy (0.4ms)[0m  [1m[31mDELETE FROM "products" WHERE "products"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.6ms | Allocations: 660)
ProductsControllerTest - test_should_destroy_product: ActiveRecord::InvalidForeignKey raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
ProductsControllerTest: test_should_get_index
---------------------------------------------
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/products" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by ProductsController#index as JSON
  Parameters: {"product"=>{}}
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 371)
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
UsersControllerTest: test_should_update_user
--------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/users/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by UsersController#update as JSON
  Parameters: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "id"=>"980190962"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :password_digest. Context: { controller: UsersController, action: update, request: #<ActionDispatch::Request:0x0000561d4d2aaf10>, params: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "controller"=>"users", "action"=>"update", "id"=>"980190962"} }[0m
Completed 422 Unprocessable Entity in 5ms (Views: 3.0ms | ActiveRecord: 0.2ms | Allocations: 2302)
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
UsersControllerTest: test_should_create_user
--------------------------------------------
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Count (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started POST "/users" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by UsersController#create as JSON
  Parameters: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}}
[31mUnpermitted parameter: :password_digest. Context: { controller: UsersController, action: create, request: #<ActionDispatch::Request:0x00007f0fd8983048>, params: {"user"=>{"email"=>"MyString", "name"=>"MyString", "password"=>"[FILTERED]", "password_digest"=>"[FILTERED]"}, "controller"=>"users", "action"=>"create"} }[0m
Completed 422 Unprocessable Entity in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 695)
  [1m[36mCACHE User Count (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_should_show_user
------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/users/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by UsersController#show as JSON
  Parameters: {"id"=>"980190962", "user"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 326)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
UsersControllerTest: test_should_destroy_user
---------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
Started DELETE "/users/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by UsersController#destroy as JSON
  Parameters: {"id"=>"980190962", "user"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Destroy (0.4ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m
Completed 500 Internal Server Error in 1ms (ActiveRecord: 0.6ms | Allocations: 545)
UsersControllerTest - test_should_destroy_user: ActiveRecord::InvalidForeignKey raised.
If you expected this exception, use `assert_raises` as near to the code that raises as possible.
Other block based assertions (e.g. `assert_difference`) can be used, as long as `assert_raises` is inside their block.

  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
UsersControllerTest: test_should_get_index
------------------------------------------
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/users" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by UsersController#index as JSON
  Parameters: {"user"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
Completed 200 OK in 1ms (Views: 0.6ms | ActiveRecord: 0.2ms | Allocations: 405)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
SalesControllerTest: test_should_update_sale
--------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started PATCH "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by SalesController#update as JSON
  Parameters: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "id"=>"980190962"}
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: update, request: #<ActionDispatch::Request:0x00007f0fd8e5b660>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"update", "id"=>"980190962"} }[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 200 OK in 7ms (Views: 0.2ms | ActiveRecord: 0.6ms | Allocations: 4864)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
--------------------------------------------
SalesControllerTest: test_should_create_sale
--------------------------------------------
  [1m[36mSale Load (0.2ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
Started POST "/sales" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by SalesController#create as JSON
  Parameters: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}}
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x0000561d4d7e8220>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x0000561d4d7e8220>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mProduct Load (0.1ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x0000561d4d7e8220>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x0000561d4d7e8220>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mCACHE Product Load (0.0ms)[0m  [1m[34mSELECT "products".* FROM "products" WHERE "products"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mUser Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Create (0.3ms)[0m  [1m[32mINSERT INTO "sales" ("quantity", "total_in_cents", "product_id", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6) RETURNING "id"[0m  [["quantity", 1], ["total_in_cents", 1], ["product_id", 980190962], ["user_id", 980190962], ["created_at", "2023-02-28 14:46:16.982628"], ["updated_at", "2023-02-28 14:46:16.982628"]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
[31mUnpermitted parameter: :total_in_cents. Context: { controller: SalesController, action: create, request: #<ActionDispatch::Request:0x0000561d4d7e8220>, params: {"sale"=>{"product_id"=>980190962, "quantity"=>1, "total_in_cents"=>1, "user_id"=>980190962}, "controller"=>"sales", "action"=>"create"} }[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mProduct Update (0.1ms)[0m  [1m[33mUPDATE "products" SET "quantity" = $1, "updated_at" = $2 WHERE "products"."id" = $3[0m  [["quantity", 0], ["updated_at", "2023-02-28 14:46:16.984037"], ["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 201 Created in 4ms (Views: 0.3ms | ActiveRecord: 0.8ms | Allocations: 2198)
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
SalesControllerTest: test_should_show_sale
------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by SalesController#show as JSON
  Parameters: {"id"=>"980190962", "sale"=>{}}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Completed 200 OK in 1ms (Views: 0.2ms | ActiveRecord: 0.1ms | Allocations: 282)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
---------------------------------------------
SalesControllerTest: test_should_destroy_sale
---------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
Started DELETE "/sales/980190962" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by SalesController#destroy as JSON
  Parameters: {"id"=>"980190962", "sale"=>{}}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mSAVEPOINT active_record_1[0m
  [1m[36mSale Destroy (0.2ms)[0m  [1m[31mDELETE FROM "sales" WHERE "sales"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mRELEASE SAVEPOINT active_record_1[0m
Completed 204 No Content in 1ms (ActiveRecord: 0.4ms | Allocations: 386)
  [1m[36mSale Count (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "sales"[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
------------------------------------------
SalesControllerTest: test_should_get_index
------------------------------------------
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales" WHERE "sales"."id" = $1 LIMIT $2[0m  [["id", 980190962], ["LIMIT", 1]]
Started GET "/sales" for 127.0.0.1 at 2023-02-28 11:46:16 -0300
Processing by SalesController#index as JSON
  Parameters: {"sale"=>{}}
  [1m[36mSale Load (0.1ms)[0m  [1m[34mSELECT "sales".* FROM "sales"[0m
Completed 200 OK in 1ms (Views: 0.5ms | ActiveRecord: 0.1ms | Allocations: 369)
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[36mUser Count (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "users"[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  [1m[36mSale Load (0.6ms)[0m  [1m[34mSELECT "sales".* FROM "sales"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSale Destroy (0.2ms)[0m  [1m[31mDELETE FROM "sales" WHERE "sales"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (3.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mSale Destroy (0.1ms)[0m  [1m[31mDELETE FROM "sales" WHERE "sales"."id" = $1[0m  [["id", 298486374]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users"[0m
  [1m[36mTRANSACTION (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (16.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Destroy (0.5ms)[0m  [1m[31mDELETE FROM "users" WHERE "users"."id" = $1[0m  [["id", 298486374]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mProduct Load (0.5ms)[0m  [1m[34mSELECT "products".* FROM "products"[0m
  [1m[36mTRANSACTION (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mProduct Destroy (0.4ms)[0m  [1m[31mDELETE FROM "products" WHERE "products"."id" = $1[0m  [["id", 980190962]]
  [1m[36mTRANSACTION (3.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mTRANSACTION (0.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mProduct Destroy (0.2ms)[0m  [1m[31mDELETE FROM "products" WHERE "products"."id" = $1[0m  [["id", 298486374]]
  [1m[36mTRANSACTION (0.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[36mActiveRecord::InternalMetadata Pluck (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "schema_sha1"], ["LIMIT", 1]]
  [1m[36mActiveRecord::SchemaMigration Pluck (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
